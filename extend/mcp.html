<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/muxi/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/muxi/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li:not(:nth-child(1)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(4) > ul > li:nth-child(1) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(4) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(4) > ul > li:nth-child(1) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(4) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(4) > ul.nav-list > li.nav-list-item:nth-child(1) > ul.nav-list { display: block; } </style> <script src="/muxi/assets/js/vendor/lunr.min.js"></script> <script src="/muxi/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>MCP Server Integration | MUXI Framework</title> <meta name="generator" content="Jekyll v4.2.2" /> <meta property="og:title" content="MCP Server Integration" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="An extensible framework for building AI agents with real-time communication capabilities, memory persistence, and tool integration" /> <meta property="og:description" content="An extensible framework for building AI agents with real-time communication capabilities, memory persistence, and tool integration" /> <link rel="canonical" href="https://ranaroussi.github.io/muxi/muxi/extend/mcp" /> <meta property="og:url" content="https://ranaroussi.github.io/muxi/muxi/extend/mcp" /> <meta property="og:site_name" content="MUXI Framework" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="MCP Server Integration" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"An extensible framework for building AI agents with real-time communication capabilities, memory persistence, and tool integration","headline":"MCP Server Integration","url":"https://ranaroussi.github.io/muxi/muxi/extend/mcp"}</script> <!-- End Jekyll SEO tag --> <script src="https://cdn.jsdelivr.net/npm/mermaid@9.3.0/dist/mermaid.min.js"></script> <script>window.addEventListener("load", function() { mermaid.initialize({ startOnLoad: true }); });</script> <style> .mermaid { text-align: center; margin: 2rem auto; max-width: 100%; padding: 1rem; } body { -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; } .site-logo { width: 40px; height: 40px; padding-right: 10px; } .site-header { display: flex; align-items: center; height: 60px; } .site-header .site-title { display: flex; align-items: center; font-weight: 700; } .site-header .site-title:hover { background-image: none; } </style> <!-- Favicon links --> <link rel="apple-touch-icon" sizes="180x180" href="/muxi/assets/images/apple-touch-icon.png"> <link rel="icon" type="image/png" sizes="32x32" href="/muxi/assets/images/favicon-32x32.png"> <link rel="icon" type="image/png" sizes="16x16" href="/muxi/assets/images/favicon-16x16.png"> <link rel="manifest" href="/muxi/assets/images/site.webmanifest"> <link rel="shortcut icon" href="/muxi/assets/images/favicon.ico"> <title>MCP Server Integration | MUXI AI Agent Framework</title> <meta name="description" content="An extensible framework for building AI agents with real-time communication capabilities, memory persistence, and tool integration"/> <meta property="og:title" content="MCP Server Integration | MUXI AI Agent Framework"/> <meta property="og:locale" content="en_US"/> <meta property="og:description" content="An extensible framework for building AI agents with real-time communication capabilities, memory persistence, and tool integration"/> <meta property="og:url" content="https://ranaroussi.github.io/muxi/muxi/extend/mcp"/> <meta property="og:site_name" content="MUXI AI Agent Framework"/> <meta property="og:type" content="website"/> <meta property="og:image" content="https://opengraph.githubassets.com/1/ranaroussi/muxi" /> <meta name="twitter:card" content="summary"/> <meta name="twitter:creator" content="@aroussi"/> <meta name="twitter:title" content="MCP Server Integration | MUXI AI Agent Framework"/> <meta name="twitter:description" content="An extensible framework for building AI agents with real-time communication capabilities, memory persistence, and tool integration"/> <meta name="twitter:image" content="https://opengraph.githubassets.com/1/ranaroussi/muxi" /> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/muxi/" class="site-title lh-tight"> MUXI Framework </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/muxi/" class="nav-list-link">Home</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Introduction category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/muxi/intro" class="nav-list-link">Introduction</a><ul class="nav-list"><li class="nav-list-item"><a href="/muxi/intro/overview" class="nav-list-link">Overview & Key Concepts</a></li><li class="nav-list-item"><a href="/muxi/intro/why-muxi" class="nav-list-link">Why MUXI?</a></li><li class="nav-list-item"><a href="/muxi/intro/quick-start" class="nav-list-link">Quick Start Guide</a></li><li class="nav-list-item"><a href="/muxi/intro/architecture" class="nav-list-link">Architecture</a></li><li class="nav-list-item"><a href="/muxi/intro/installation" class="nav-list-link">Installation</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Building Agents category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/muxi/agents" class="nav-list-link">Building Agents</a><ul class="nav-list"><li class="nav-list-item"><a href="/muxi/agents/simple" class="nav-list-link">Simple Agent</a></li><li class="nav-list-item"><a href="/muxi/agents/memory" class="nav-list-link">Context Memory</a></li><li class="nav-list-item"><a href="/muxi/agents/configuration" class="nav-list-link">Agent Configuration</a></li><li class="nav-list-item"><a href="/muxi/agents/multi-agent" class="nav-list-link">Multi-Agent Systems</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Extending Capabilities category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/muxi/extend" class="nav-list-link">Extending Capabilities</a><ul class="nav-list"><li class="nav-list-item"><a href="/muxi/extend/mcp" class="nav-list-link">MCP Server Integration</a></li><li class="nav-list-item"><a href="/muxi/extend/knowledge" class="nav-list-link">Context Knowledge</a></li></ul></li><li class="nav-list-item"><a href="/muxi/clients" class="nav-list-link">Interfaces & Clients</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Technical Deep Dives category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/muxi/technical" class="nav-list-link">Technical Deep Dives</a><ul class="nav-list"><li class="nav-list-item"><a href="/muxi/technical/agents" class="nav-list-link">Agents & Models</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Memory System category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/muxi/technical/memory" class="nav-list-link">Memory System</a><ul class="nav-list"><li class="nav-list-item"><a href="/muxi/technical/memory/buffer" class="nav-list-link">Buffer Memory</a></li></ul></li><li class="nav-list-item"><a href="/muxi/technical/mcp" class="nav-list-link">MCP System</a></li><li class="nav-list-item"><a href="/muxi/technical/communication" class="nav-list-link">Communication</a></li></ul></li><li class="nav-list-item"><a href="/muxi/development" class="nav-list-link">Development</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Reference category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/muxi/reference" class="nav-list-link">Reference</a><ul class="nav-list"><li class="nav-list-item"><a href="/muxi/reference/api" class="nav-list-link">API Documentation</a></li><li class="nav-list-item"><a href="/muxi/reference/configuration" class="nav-list-link">Configuration Options</a></li><li class="nav-list-item"><a href="/muxi/reference/package" class="nav-list-link">Package Structure</a></li><li class="nav-list-item"><a href="/muxi/reference/examples" class="nav-list-link">Examples Library</a></li><li class="nav-list-item"><a href="/muxi/reference/comparisons" class="nav-list-link">Framework Comparisons</a></li></ul></li><li class="nav-list-item"><a href="/muxi/release-notes" class="nav-list-link">Release Notes</a></li><li class="nav-list-item"><a href="/muxi/roadmap" class="nav-list-link">Project Roadmap</a></li></ul> <ul class="nav-list"><li class="nav-list-item external"> <a href="https://github.com/ranaroussi/muxi" class="nav-list-link external" target="_blank" rel="noopener noreferrer" > MUXI on GitHub <svg viewBox="0 0 24 24" aria-labelledby="svg-external-link-title"><use xlink:href="#svg-external-link"></use></svg> </a> </li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search MUXI Framework" aria-label="Search MUXI Framework" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://github.com/ranaroussi/muxi" class="site-button" target="_blank" rel="noopener noreferrer" > MUXI on GitHub </a> </li> </ul> </nav> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/muxi/extend">Extending Capabilities</a></li> <li class="breadcrumb-nav-list-item"><span>MCP Server Integration</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h1 id="mcp-server-integration"> <a href="#mcp-server-integration" class="anchor-heading" aria-labelledby="mcp-server-integration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> MCP Server Integration </h1> <p class="fs-5 fw-600">Model Context Protocol (MCP) is a standardized protocol that allows AI applications to access specialized capabilities, share context with language models, and expose tools to AI systems. This guide explains how to integrate external MCP servers with your MUXI agents.</p> <h2 id="introduction-to-mcp"> <a href="#introduction-to-mcp" class="anchor-heading" aria-labelledby="introduction-to-mcp"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Introduction to MCP </h2> <p>MCP enables your agents to leverage external tools and capabilities through a standardized interface. The MCP handler in MUXI manages the connections to MCP servers, abstracting the complexities of the transport layer from your application code.</p> <p>Key features of the MUXI MCP implementation include:</p> <ul> <li>Support for multiple transport types (HTTP+SSE and Command-line)</li> <li>Robust reconnection with exponential backoff</li> <li>Cancellation support for long-running operations</li> <li>Comprehensive error handling and diagnostic information</li> <li>Integration with the official MCP Python SDK</li> </ul> <h2 id="connecting-to-mcp-servers"> <a href="#connecting-to-mcp-servers" class="anchor-heading" aria-labelledby="connecting-to-mcp-servers"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Connecting to MCP Servers </h2> <p>There are two ways to connect your agents to MCP servers:</p> <h3 id="1-using-configuration-files"> <a href="#1-using-configuration-files" class="anchor-heading" aria-labelledby="1-using-configuration-files"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1. Using Configuration Files </h3> <p>The simplest approach is to define MCP servers in your agent configuration:</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">name</span><span class="pi">:</span> <span class="s">my_assistant</span>
<span class="na">system_message</span><span class="pi">:</span> <span class="s">You are a helpful assistant with access to external tools.</span>
<span class="na">model</span><span class="pi">:</span>
  <span class="na">provider</span><span class="pi">:</span> <span class="s">openai</span>
  <span class="na">api_key</span><span class="pi">:</span> <span class="s2">"</span><span class="s">${OPENAI_API_KEY}"</span>
  <span class="na">model</span><span class="pi">:</span> <span class="s">gpt-4o</span>
  <span class="na">temperature</span><span class="pi">:</span> <span class="m">0.7</span>
<span class="na">mcp_servers</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">web_search</span>
  <span class="na">url</span><span class="pi">:</span> <span class="s">http://localhost:5001</span>
  <span class="na">credentials</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s">search_api_key</span>
    <span class="na">param_name</span><span class="pi">:</span> <span class="s">api_key</span>
    <span class="na">required</span><span class="pi">:</span> <span class="no">true</span>
    <span class="na">env_fallback</span><span class="pi">:</span> <span class="s">SEARCH_API_KEY</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">calculator</span>
  <span class="na">command</span><span class="pi">:</span> <span class="s">npx -y @modelcontextprotocol/server-calculator</span>
</code></pre></div></div> <h3 id="2-programmatically"> <a href="#2-programmatically" class="anchor-heading" aria-labelledby="2-programmatically"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2. Programmatically </h3> <p>You can also connect to MCP servers programmatically:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">muxi</span> <span class="kn">import</span> <span class="n">muxi</span>

<span class="c1"># Initialize MUXI
</span><span class="n">app</span> <span class="o">=</span> <span class="n">muxi</span><span class="p">()</span>

<span class="c1"># Add an agent
</span><span class="k">await</span> <span class="n">app</span><span class="p">.</span><span class="n">add_agent</span><span class="p">(</span><span class="s">"assistant"</span><span class="p">,</span> <span class="s">"configs/assistant.yaml"</span><span class="p">)</span>

<span class="c1"># Connect to an HTTP-based MCP server
</span><span class="k">await</span> <span class="n">app</span><span class="p">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s">"assistant"</span><span class="p">).</span><span class="n">connect_mcp_server</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s">"weather"</span><span class="p">,</span>
    <span class="n">url</span><span class="o">=</span><span class="s">"http://localhost:5001"</span><span class="p">,</span>
    <span class="n">credentials</span><span class="o">=</span><span class="p">{</span><span class="s">"api_key"</span><span class="p">:</span> <span class="s">"your_weather_api_key"</span><span class="p">}</span>
<span class="p">)</span>

<span class="c1"># Connect to a command-line MCP server
</span><span class="k">await</span> <span class="n">app</span><span class="p">.</span><span class="n">get_agent</span><span class="p">(</span><span class="s">"assistant"</span><span class="p">).</span><span class="n">connect_mcp_server</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s">"calculator"</span><span class="p">,</span>
    <span class="n">command</span><span class="o">=</span><span class="s">"npx -y @modelcontextprotocol/server-calculator"</span>
<span class="p">)</span>
</code></pre></div></div> <h2 id="transport-types"> <a href="#transport-types" class="anchor-heading" aria-labelledby="transport-types"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Transport Types </h2> <p>MUXI supports two transport types for MCP servers, automatically selected based on the parameters you provide:</p> <h3 id="httpsse-transport"> <a href="#httpsse-transport" class="anchor-heading" aria-labelledby="httpsse-transport"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> HTTP+SSE Transport </h3> <p>This transport type is used for web-based MCP servers that follow the HTTP+SSE protocol. It’s automatically selected when you provide a <code class="language-plaintext highlighter-rouge">url</code> parameter:</p> <ul> <li>Client → Server messages go through HTTP POST requests</li> <li>Server → Client messages go through Server-Sent Events (SSE)</li> <li>Requires maintaining long-lived connections</li> </ul> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">await</span> <span class="n">agent</span><span class="p">.</span><span class="n">connect_mcp_server</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s">"web_search"</span><span class="p">,</span>
    <span class="n">url</span><span class="o">=</span><span class="s">"http://localhost:5001"</span><span class="p">,</span>
    <span class="n">credentials</span><span class="o">=</span><span class="p">{</span><span class="s">"api_key"</span><span class="p">:</span> <span class="s">"your_api_key"</span><span class="p">}</span>
<span class="p">)</span>
</code></pre></div></div> <h3 id="command-line-transport"> <a href="#command-line-transport" class="anchor-heading" aria-labelledby="command-line-transport"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Command-line Transport </h3> <p>This transport type is used for local MCP servers that run as executable processes. It’s automatically selected when you provide a <code class="language-plaintext highlighter-rouge">command</code> parameter:</p> <ul> <li>Servers are started via command-line</li> <li>Communication happens via standard input/output</li> <li>Suitable for local development and testing</li> </ul> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">await</span> <span class="n">agent</span><span class="p">.</span><span class="n">connect_mcp_server</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s">"calculator"</span><span class="p">,</span>
    <span class="n">command</span><span class="o">=</span><span class="s">"npx -y @modelcontextprotocol/server-calculator"</span><span class="p">,</span>
    <span class="n">credentials</span><span class="o">=</span><span class="p">{</span><span class="s">"api_key"</span><span class="p">:</span> <span class="s">"your_api_key"</span><span class="p">}</span>
<span class="p">)</span>
</code></pre></div></div> <h2 id="mcp-server-credentials"> <a href="#mcp-server-credentials" class="anchor-heading" aria-labelledby="mcp-server-credentials"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> MCP Server Credentials </h2> <p>MCP servers may require credentials for authentication, though many servers don’t need any authentication. Credentials are completely optional:</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">mcp_servers</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">web_search</span>
  <span class="na">url</span><span class="pi">:</span> <span class="s">http://localhost:5001</span>
  <span class="na">credentials</span><span class="pi">:</span>  <span class="c1"># Optional: can be omitted if no authentication is required</span>
  <span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s">search_api_key</span>
    <span class="na">param_name</span><span class="pi">:</span> <span class="s">api_key</span>
    <span class="na">required</span><span class="pi">:</span> <span class="no">true</span>
    <span class="na">env_fallback</span><span class="pi">:</span> <span class="s">SEARCH_API_KEY</span>
</code></pre></div></div> <p>Or programmatically:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># With credentials
</span><span class="k">await</span> <span class="n">agent</span><span class="p">.</span><span class="n">connect_mcp_server</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s">"web_search"</span><span class="p">,</span>
    <span class="n">url</span><span class="o">=</span><span class="s">"http://localhost:5001"</span><span class="p">,</span>
    <span class="n">credentials</span><span class="o">=</span><span class="p">{</span><span class="s">"api_key"</span><span class="p">:</span> <span class="s">"your_api_key"</span><span class="p">}</span>
<span class="p">)</span>

<span class="c1"># Without credentials (passing None or omitting the parameter are both valid)
</span><span class="k">await</span> <span class="n">agent</span><span class="p">.</span><span class="n">connect_mcp_server</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s">"calculator"</span><span class="p">,</span>
    <span class="n">url</span><span class="o">=</span><span class="s">"http://localhost:5002"</span>
<span class="p">)</span>
</code></pre></div></div> <h2 id="using-mcp-servers-in-agents"> <a href="#using-mcp-servers-in-agents" class="anchor-heading" aria-labelledby="using-mcp-servers-in-agents"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Using MCP Servers in Agents </h2> <p>Once an MCP server is connected to an agent, the agent can automatically use it when needed. The LLM will receive information about available tools from MCP servers and can call them as needed.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Agent will automatically use connected MCP servers when appropriate
</span><span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">app</span><span class="p">.</span><span class="n">chat</span><span class="p">(</span>
    <span class="s">"What's the weather in New York? Also, what's 123 * 456?"</span>
<span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">content</span><span class="p">)</span>
</code></pre></div></div> <h2 id="handling-disconnections"> <a href="#handling-disconnections" class="anchor-heading" aria-labelledby="handling-disconnections"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Handling Disconnections </h2> <p>The MCP handler automatically manages reconnections using an exponential backoff strategy, but you can also manually disconnect and reconnect:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Disconnect from an MCP server
</span><span class="k">await</span> <span class="n">agent</span><span class="p">.</span><span class="n">disconnect_mcp_server</span><span class="p">(</span><span class="s">"web_search"</span><span class="p">)</span>

<span class="c1"># Reconnect to the MCP server
</span><span class="k">await</span> <span class="n">agent</span><span class="p">.</span><span class="n">connect_mcp_server</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s">"web_search"</span><span class="p">,</span>
    <span class="n">url</span><span class="o">=</span><span class="s">"http://localhost:5001"</span><span class="p">,</span>
    <span class="n">credentials</span><span class="o">=</span><span class="p">{</span><span class="s">"api_key"</span><span class="p">:</span> <span class="s">"your_api_key"</span><span class="p">}</span>
<span class="p">)</span>
</code></pre></div></div> <h2 id="cancellation-support"> <a href="#cancellation-support" class="anchor-heading" aria-labelledby="cancellation-support"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Cancellation Support </h2> <p>You can cancel long-running MCP operations if needed:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">muxi.core.mcp_handler</span> <span class="kn">import</span> <span class="n">CancellationToken</span>

<span class="c1"># Create a cancellation token
</span><span class="n">token</span> <span class="o">=</span> <span class="n">CancellationToken</span><span class="p">()</span>

<span class="c1"># Execute a potentially long-running operation
</span><span class="n">task</span> <span class="o">=</span> <span class="n">agent</span><span class="p">.</span><span class="n">execute_tool</span><span class="p">(</span><span class="s">"web_search"</span><span class="p">,</span> <span class="p">{</span><span class="s">"query"</span><span class="p">:</span> <span class="s">"complex research topic"</span><span class="p">},</span> <span class="n">token</span><span class="p">)</span>

<span class="c1"># Cancel the operation if needed
</span><span class="n">token</span><span class="p">.</span><span class="n">cancel</span><span class="p">()</span>
</code></pre></div></div> <h2 id="error-handling"> <a href="#error-handling" class="anchor-heading" aria-labelledby="error-handling"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Error Handling </h2> <p>The MCP handler provides comprehensive error handling with specific exception types:</p> <ul> <li><code class="language-plaintext highlighter-rouge">MCPError</code>: Base exception for all MCP-related errors</li> <li><code class="language-plaintext highlighter-rouge">MCPConnectionError</code>: For connection-related errors</li> <li><code class="language-plaintext highlighter-rouge">MCPRequestError</code>: For errors when making requests</li> <li><code class="language-plaintext highlighter-rouge">MCPTimeoutError</code>: For timeout errors</li> <li><code class="language-plaintext highlighter-rouge">MCPCancelledError</code>: For canceled operations</li> </ul> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">muxi.core.mcp_handler</span> <span class="kn">import</span> <span class="n">MCPError</span><span class="p">,</span> <span class="n">MCPConnectionError</span>

<span class="k">try</span><span class="p">:</span>
    <span class="k">await</span> <span class="n">agent</span><span class="p">.</span><span class="n">connect_mcp_server</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s">"web_search"</span><span class="p">,</span>
        <span class="n">url</span><span class="o">=</span><span class="s">"http://non-existent-server.com"</span><span class="p">,</span>
        <span class="n">credentials</span><span class="o">=</span><span class="p">{}</span>
    <span class="p">)</span>
<span class="k">except</span> <span class="n">MCPConnectionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Failed to connect: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
<span class="k">except</span> <span class="n">MCPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"General MCP error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div></div> <h2 id="diagnostics"> <a href="#diagnostics" class="anchor-heading" aria-labelledby="diagnostics"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Diagnostics </h2> <p>You can get detailed diagnostic information about MCP server connections:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Get connection statistics for all MCP servers
</span><span class="n">stats</span> <span class="o">=</span> <span class="n">agent</span><span class="p">.</span><span class="n">mcp_handler</span><span class="p">.</span><span class="n">get_connection_stats</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">stats</span><span class="p">)</span>

<span class="c1"># Output example:
# {
#     "active_connections": 2,
#     "registered_tools": 5,
#     "active_operations": 0,
#     "current_time": "2023-07-15T10:30:45.123456",
#     "connections": {
#         "web_search": {
#             "connected": true,
#             "url": "http://localhost:5001",
#             "command": null,
#             "session_id": "abc123",
#             "connect_time": "2023-07-15T10:25:30.123456",
#             "connection_age_s": 315.0,
#             "last_activity": "2023-07-15T10:28:45.123456",
#             "idle_time_s": 120.0
#         },
#         "calculator": {
#             "connected": true,
#             "url": null,
#             "command": "npx -y @modelcontextprotocol/server-calculator",
#             "pid": 12345
#         }
#     }
# }
</span></code></pre></div></div> <h2 id="best-practices"> <a href="#best-practices" class="anchor-heading" aria-labelledby="best-practices"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Best Practices </h2> <ol> <li><strong>Use Standard MCP Servers</strong>: Prefer well-tested, community-maintained MCP servers when possible</li> <li><strong>Handle Credentials Securely</strong>: Use environment variables for sensitive credentials</li> <li><strong>Implement Proper Error Handling</strong>: Catch and handle MCP-related exceptions appropriately</li> <li><strong>Monitor Connection Health</strong>: Periodically check connection statistics for potential issues</li> <li><strong>Set Appropriate Timeouts</strong>: Configure request timeouts based on expected operation duration</li> </ol> <h2 id="available-mcp-servers"> <a href="#available-mcp-servers" class="anchor-heading" aria-labelledby="available-mcp-servers"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Available MCP Servers </h2> <p>While MUXI doesn’t include built-in MCP servers, it has been tested with the following external MCP servers:</p> <ol> <li><strong>Web Search</strong>: MCP servers that provide web search capabilities</li> <li><strong>Weather</strong>: MCP servers for weather information</li> <li><strong>Calculator</strong>: Basic calculator functionality</li> <li><strong>Brave Search</strong>: Integration with Brave search engine</li> </ol> <p>To use these servers, you’ll need to install and configure them separately according to their documentation.</p> <h2 id="advanced-configuration"> <a href="#advanced-configuration" class="anchor-heading" aria-labelledby="advanced-configuration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Advanced Configuration </h2> <p>For advanced scenarios, you can configure additional parameters:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">await</span> <span class="n">agent</span><span class="p">.</span><span class="n">connect_mcp_server</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s">"web_search"</span><span class="p">,</span>
    <span class="n">url</span><span class="o">=</span><span class="s">"http://localhost:5001"</span><span class="p">,</span>
    <span class="n">credentials</span><span class="o">=</span><span class="p">{</span><span class="s">"api_key"</span><span class="p">:</span> <span class="s">"your_api_key"</span><span class="p">},</span>
    <span class="n">request_timeout</span><span class="o">=</span><span class="mi">120</span>  <span class="c1"># Timeout in seconds
</span><span class="p">)</span>
</code></pre></div></div> <h2 id="conclusion"> <a href="#conclusion" class="anchor-heading" aria-labelledby="conclusion"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Conclusion </h2> <p>MCP server integration enables your MUXI agents to leverage external capabilities through a standardized protocol. By following this guide, you can connect your agents to various MCP servers and enhance their capabilities.</p> </main> <hr> <footer> <p><a href="#top" id="back-to-top">Back to top</a></p> <p class="text-small text-grey-dk-100 mb-0">Copyright &copy; 2025 Ran Aroussi.<br>Licensed under Creative's Commons Attribution-NonCommercial-NoDerivatives 4.0 (CC BY-NC-ND 4.0) license.</p> </footer> </div> </div> <div class="search-overlay"></div> </div> <script src="https://cdn.jsdelivr.net/npm/mermaid@9.1.6/dist/mermaid.min.js"></script> <script> var config = {} ; mermaid.initialize(config); window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid')); </script> </body> </html>
